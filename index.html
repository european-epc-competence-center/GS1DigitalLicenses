<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>GS1 Digital Licenses</title>
  <script class="remove" src="https://www.w3.org/Tools/respec/respec-w3c"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script class="remove">
    var respecConfig = {
      noTitle: true,
      specStatus: "unofficial",
      group: null,
      historyURI: null,
      shortName: "gs1-digital-license",
      doSectionNumbering: true,
      editors: [
        {
          name: "Paul Dietrich",
          company: "GS1 Global Office",
        }
      ],
      github: "https://github.com/woodycreek/GS1DigitalLicenses",
      format: "html",
      editorsDraft: "https://woodycreek.github.io/GS1DigitalLicenses/",
      latestVersion: "https://woodycreek.github.io/GS1DigitalLicenses/",
      noRecTrack: true,
      includePermalinks: true,
    };
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
  <link rel="stylesheet" href="./gs1-respec.css">

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const tabs = document.querySelectorAll(".tab-buttons button");
      const contents = document.querySelectorAll(".tab-content");
      tabs.forEach((btn, i) => {
        btn.addEventListener("click", () => {
          tabs.forEach(b => b.classList.remove("active"));
          contents.forEach(c => c.classList.remove("active"));
          tabs[i].classList.add("active");
          contents[i].classList.add("active");
        });
      });
    });
  </script>
</head>
<body>

  <div class="gs1-header">
    <div class="gs1-topbar">
      <img src="https://gs1go2.azureedge.net/cdn/ff/9s7YciihOJPDOqdxcJZACpQozarnaECzUHunMD7jqtc/1743699494/:relative:/themes/custom/gsone_revamp/logo.png"
           alt="GS1 Logo" class="gs1-logo">
      <span class="gs1-site">ref.gs1.org</span>
      <span class="gs1-tagline">The Global Language of Business</span>
    </div>

    <div class="gs1-banner">
      <span class="gs1-badge">Editors Version</span>
      <h1>GS1 Digital Licenses</h1>
      <p>Developers Introduction to the GS1 Digital License Ecosystem</p>
    <div class="gs1-buttons">
      <a href="https://woodycreek.github.io/GS1DigitalLicenses/" class="gs1-btn">Latest version</a>
    </div>
    </div>
  </div>

<section id="abstract" data-include="abstract.html"></section>
<section id="overview" data-include="overview.html"></section>
<section id="licensing" data-include="licensing.html"></section>
<section id="license-validation" data-include="license_validation.html"></section>
<section id="creating-keys" data-include="creating_keys.html"></section>
<section id="validating-keys" data-include="validating_keys.html"></section>
<section id="creating-data" data-include="creating_data.html"></section>
<section id="validating-data" data-include="validating_data.html"></section>
<section id="revocation" data-include="revocation.html"></section>
<section id="tricky-topics" data-include="tricky_topics.html"></section>

<section id="conformance">
  <h2>Conformance</h2>
  <p>
    A conforming implementation is one that meets all the requirements expressed
    in the normative sections of this specification. In addition, a conforming
    implementation <strong>MAY</strong> provide additional functionality, as long as it does not
    contradict or override the requirements of this specification.
  </p>
  <p>
    Implementations <strong>MAY</strong> use alternative mechanisms that are functionally
    equivalent to those described in this specification.
  </p>
</section>

<section id="tof" class="appendix"></section>

<script>
  async function waitForIncludes() {
   console.log("ðŸ•“ Waiting for ReSpec...");
   await document.respecIsReady;

    // Wait until all data-includes have finished loading
    const includes = document.querySelectorAll("[data-include]");
    console.log("ðŸ•“ Waiting for data-includes...");
    await Promise.all([...includes].map(section => {
      return new Promise(resolve => {
        const observer = new MutationObserver(() => {
          if (section.children.length > 0) {
            observer.disconnect();
            resolve();
          }
        });
        observer.observe(section, { childList: true });
      });
    }));
    console.log("âœ… ReSpec ready â€” initializing tabs");
  }

  (async () => {
    await waitForIncludes();

    document.querySelectorAll('.example-tabset').forEach(container => {
      const exampleId = container.dataset.example;
      const buttons = container.querySelectorAll('button[data-tab]');
      const codes = container.querySelectorAll('pre');

      const firstBtn = container.querySelector('button.active') || buttons[0];
      const firstTab = container.querySelector(`#${exampleId}-${firstBtn.dataset.tab}`);

      showTab(firstBtn, firstTab);

      buttons.forEach(button => {
        const tabName = button.dataset.tab;
        const target = container.querySelector(`#${exampleId}-${tabName}`);
        button.addEventListener('click', () => showTab(button, target));
      });

      function showTab(activeButton, showEl) {
        buttons.forEach(btn => btn.classList.remove('active'));
        codes.forEach(pre => pre.style.display = 'none');

        activeButton.classList.add('active');
        showEl.style.display = 'block';

        const code = showEl.querySelector('code');
        if (!code.dataset.loaded && code.dataset.src) {
          fetch(code.dataset.src)
            .then(res => res.ok ? res.text() : Promise.reject(res))
            .then(text => {
              code.textContent = text;
              code.dataset.loaded = "true";
              if (window.hljs && typeof hljs.highlightElement === 'function') {
                // Delay ensures content is in DOM before highlight is applied
                setTimeout(() => hljs.highlightElement(code), 0);
              }
            })
            .catch(() => code.textContent = "Failed to load example.");
        }
      }
    });

    // Optionally highlight all static <code> blocks on the page
    if (window.hljs && typeof hljs.highlightAll === 'function') {
      hljs.highlightAll();
    }
  })();

  function decodeBase64Url(base64Url) {
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const padded = base64 + '='.repeat((4 - base64.length % 4) % 4);
    return atob(padded);
  }

</script>


</body>
</html>
